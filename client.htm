<!DOCTYPE html>
<html>
<body>

<h1>My First JavaScript</h1>

<script>
const socket = new WebSocket("ws://192.168.1.30:8080/ws");  //localhost should be the server's local ip address.

const encoder = new TextEncoder()

// Connection established with the server 
socket.onopen = function(event) {
  console.log("Connection Established.");
  var w = screen.width;
  var h = screen.height;
};

// Message is received from server
socket.onmessage = function(event) {
  const message = event.data;
  console.log("Recieved message: " + message);

};

// Connection closed.
socket.onclose = function(event) {
  console.log("Connection closed.");
};

// Sending mouse coordinates to server as byte array
function sendMouseMovement(x, y) {
  const movement = { x: x, y: y };
  socket.send(encoder.encode(JSON.stringify(movement)));
}

function sendMouseClick() {
  socket.send("LeftClick")
}

// Listening mouse events and getting x, y coordinates.
document.addEventListener("mousemove", function(event) {
  const x = Math.round(event.offsetX);
  const y = Math.round(event.offsetY);
  sendMouseMovement(x, y);
});

// Listening touch events and getting x, y coordinates.
document.addEventListener("touchmove", function(event) {
  const touch = event.touches[0];
  const x = Math.round(touch.screenX);
  const y = Math.round(touch.screenY);
  sendMouseMovement(x, y);
});


document.addEventListener("touchstart", function(event) {
  sendMouseClick();
});
</script>

</body>
</html> 

